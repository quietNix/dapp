(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{13:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=13},56:function(e,t,n){"use strict";n.r(t),n.d(t,"store",(function(){return F}));var a=n(0),c=n.n(a),r=n(8),s=n.n(r),i=n(3),o=n(21),u=n(2),l=n.n(u),d=n(5),j=n(6),h=n.n(j),b=(n(36),n(53),h()({peers:["https://quietnix-dapp.herokuapp.com/gun"]})),m=b.user().recall({sessionStorage:!0});function p(e){F.dispatch({type:"USER_AUTH_STATUS",payload:e})}m.get("alias").on((function(e){return p(e)})),b.on("auth",function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.get("alias");case 2:p(n=e.sent),console.log("signed in as ".concat(n));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var O=n(1);var v=Object(i.b)((function(e){return{username:e.username}}))((function(e){var t=e.username;return Object(O.jsxs)("header",{children:[Object(O.jsx)("h1",{children:"\ud83d\udcac"}),""===t?Object(O.jsx)("h3",{children:"Dapp Chat"}):Object(O.jsxs)(a.Fragment,{children:[Object(O.jsxs)("div",{className:"user-bio",children:[Object(O.jsx)("span",{children:Object(O.jsx)("strong",{children:t})}),Object(O.jsx)("img",{src:"https://avatars.dicebear.com/api/initials/".concat(t,".svg"),alt:"avatar"})]}),Object(O.jsx)("button",{className:"signout-button",onClick:function(){m.leave(),p("")},children:"Sign Out"})]})]})})),f=n(20),x=n(10);n(55);var g=function(e){var t=e.who===e.sender?"sent":"received",n="https://avatars.dicebear.com/api/initials/".concat(e.who,".svg"),a=new Date(e.when);return Object(O.jsxs)("div",{className:"message ".concat(t),children:[Object(O.jsx)("img",{src:n,alt:"avatar"}),Object(O.jsxs)("div",{className:"message-text",children:[Object(O.jsx)("p",{children:e.what}),Object(O.jsx)("time",{children:a.toLocaleTimeString()})]})]})};var w=function(){function e(){var e=document.getElementById("username").value,t=document.getElementById("password").value;m.auth(e,t,(function(e){var t=e.err;return t&&alert(t)}))}return Object(O.jsxs)("div",{children:[Object(O.jsx)("label",{htmlFor:"username",children:"Username"}),Object(O.jsx)("input",{className:"credential",id:"username",name:"username",value:undefined,minLength:"3",maxLength:"16"}),Object(O.jsx)("label",{htmlFor:"password",children:"Password"}),Object(O.jsx)("input",{className:"credential",id:"password",name:"password",value:undefined,type:"password"}),Object(O.jsx)("button",{className:"login",onClick:e,children:"Login"}),Object(O.jsx)("button",{className:"login",onClick:function(){var t=document.getElementById("username").value,n=document.getElementById("password").value;m.create(t,n,(function(t){var n=t.err;n?alert(n):e()}))},children:"Sign Up"})]})},y=h.a.SEA,S=!1;function N(){var e=document.getElementById("cont");e.scrollTop=e.scrollHeight}var k=Object(i.b)((function(e){return{username:e.username}}))((function(e){var t=e.username,n=Object(a.useState)(!0),c=Object(x.a)(n,2),r=c[0],s=c[1],i=Object(a.useState)(""),o=Object(x.a)(i,2),u=o[0],j=o[1],p=Object(a.useState)([]),v=Object(x.a)(p,2),k=v[0],E=v[1],T=[];function C(){return(C=Object(d.a)(l.a.mark((function e(t){var n,a,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,y.encrypt(u,"#Nikhil");case 3:n=e.sent,a=(new Date).toISOString(),c=m.get("all").set({what:n}),b.get("chat").get(a).put(c),j(""),s(!0),N();case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){""!==t&&b.get("chat").map().once(function(){var e=Object(d.a)(l.a.mark((function e(t,n){var a,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=12;break}return a="#Nikhil",e.next=4,b.user(t).get("alias");case 4:return e.t0=e.sent,e.next=7,y.decrypt(t.what,a);case 7:e.t1=e.sent,e.t2=e.t1+"",e.t3=h.a.state.is(t,"what"),(c={who:e.t0,what:e.t2,when:e.t3}).what&&(T=[].concat(Object(f.a)(T.slice(-50)),[c]).sort((function(e,t){return e.when-t.when})),E(T),r?(N(),s(!1)):S=!0);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}),[t]),Object(O.jsx)("div",{className:"container",children:""===t?Object(O.jsx)("div",{className:"div-main",children:Object(O.jsx)(w,{})}):Object(O.jsxs)(a.Fragment,{children:[Object(O.jsx)("main",{onScroll:function(){console.log("scroll")},id:"cont",children:k.map((function(e){return Object(O.jsx)(g,{id:e.when,when:e.when,what:e.what,who:e.who,sender:t},e.when)}))}),Object(O.jsxs)("form",{onSubmit:function(e){return C.apply(this,arguments)},children:[Object(O.jsx)("input",{type:"text",placeholder:"Type a message...",onChange:function(e){var t=e.target.value;j(t)},value:u,maxLength:"100"}),Object(O.jsx)("button",{className:"sent-emogy",type:"submit",disabled:!u,children:"\ud83d\udee9\ufe0f"})]}),r?"":Object(O.jsx)("div",{className:"scroll-button",children:Object(O.jsx)("button",{onClick:N,children:S?"\ud83d\udcac":"\ud83d\udc47"})})]})})}));var E=function(e){return Object(O.jsxs)("div",{className:"app",children:[Object(O.jsx)(v,{}),Object(O.jsx)(k,{})]})},T=n(16),C={username:""},U=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,57)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),a(e),c(e),r(e),s(e)}))},F=Object(o.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"USER_AUTH_STATUS"===t.type?Object(T.a)(Object(T.a)({},e),{},{username:t.payload}):e}));s.a.render(Object(O.jsx)(c.a.StrictMode,{children:Object(O.jsx)(i.a,{store:F,children:Object(O.jsx)(E,{})})}),document.getElementById("root")),U()}},[[56,1,2]]]);
//# sourceMappingURL=main.f9bc4f90.chunk.js.map